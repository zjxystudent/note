# 命令式和声明式

从范式上看，试图从框架通常风味命令式和声明式

## 命令式框架

命令式框架有一特定,**关注过程**。自然语言描述能与代码产生一一对应的关系

```jQuery
$('#app')//获取 div
	.text('hello world')//设置文本内容
	.on('click',()=>{alert('ok')})//绑定点击事件
```

```javascript
const div = document.querySelector("#app"); //获取 div
div.innerText = "hello world"; //设置文本内容
div.addEventListener("click", () => {
  alert("ok");
}); //绑定点击事件
```

## 声明式框架

声明式框架更关注结果。

```vue
<div @click="() => alert('ok')">hello world</div>
```

_声明式框架性能<=命令式框架性能_

# 基本操作

给出一个对象 obj，可以对它进行影响操作，如读取属性值，设置属性值。

```js
obj.foo; //读取属性foo的值
obj.foo++; //读取和设置属性foo的值
```

类似这种读取、设置属性值的操作，就属于基本语义操作，即基本操作。

# 复合操作/非基本操作

如调用对象下的方法。

```js
obj.fn();
```

实际上，调用一个对象下的方法，是由两个基本语义组成的。第一个基本语义是 get，即先通过 get 操作得到 obj.fn 属性。第二个基本语义是函数调用，即通过 get 得到 obj.fn 的值后再调用它，也就是我们上面说到的 apply。

# 常规对象与异质对象

任何不属于常规对象（ordinary object）的对象都是异质对象（ exotic object）

## 内部方法

指的是当我们对一个对象进行操作时在==引擎内部调用==的方法。这些方法对 JavaScript 使用者来说时不可见的。

```js
obj.foo;
```

引擎内部会调用`[[Get]]`这个内部方法来读取属性值。在`ECMAScript`规范中使用 `[[xxx]]`来代表内部方法或内部槽。

包含`[[Get]]`在内，一个对象必须部署 11 个必要的内部方法

| 内部方法                | 签名                                          | proxy 代理方法                                              |
| ----------------------- | --------------------------------------------- | ----------------------------------------------------------- |
| `[[GetPrototypeOf]]`    | ( ) -> Object \| null                         | getPrototypeOf(target)                                      |
| `[[SetPrototypeOf]]`    | ( Object \| null ) -> Boolean                 | setPrototypeOf(target, proto)                               |
| `[[IsExtensible]]`      | ( ) -> Boolean                                | isExtensible(target)                                        |
| `[[PreventExtensions]]` | ( ) -> Boolean                                | preventExtensions(target)                                   |
| `[[GetOwnProperty]]`    | ( propertyKey ) -> Undefined                  | PropertyDescriptorgetOwnPropertyDescriptor(target, propKey) |
| `[[DefineOwnProperty]]` | ( propertyKey,PropertyDescriptor ) -> Boolean | defineProperty(target, propKey, propDesc)                   |
| `[[HasProperty]]`       | ( propertyKey ) -> Boolean                    | has(target, propKey)                                        |
| `[[Get]]`               | ( propertyKey,Receiver ) -> any               | get(target, propKey, receiver)                              |
| `[[Set]]`               | ( propertyKey,value,Receiver ) -> Boolean     | set(target, propKey, value, receiver)                       |
| `[[Delete]]`            | ( propertyKey ) -> Boolean                    | deleteProperty(target, propKey)                             |
| `[[OwnPropertyKeys]]`   | ( ) -> List of propertyKey                    | ownKeys(target)                                             |

## 额外的必要内部方法

| 内部方法        | 签名                              | proxy 代理方法              |
| --------------- | --------------------------------- | --------------------------- |
| `[[Call]]`      | ( any, a List of any) -> any      | apply(target, object, args) |
| `[[Construct]]` | ( a List of any,Object) -> Object | construct(target, args)     |

常规对象就是指:

- 对于必要的内部方法,必须使用 ECMA 规范 10.1.x 节给出的定义实现
- 对于  `[[Call]]`,必须使用 ECMA 规范 10.2.1 节给出的定义实现
- 对于  `[[Construct]]`,必须使用 ECMA 规范 10.2.2 节给出的定义实现

所有不符合以上三点的都是异质对象。

# 装饰器

在不改变原对象的基础上，通过对其添加属性或方法来进行包装拓展，使得原有对象可以动态具有更多功能。

vuex（vue2中的状态管理工具） 中对数据进行操作都是直接或间接得使用mutation 。mutation 只能进行同步操作，action对其进行包装扩展进行异步操作。

# 状态

会产生变化的数据

# 编程风格

## 尤达表达式

这种风格的命名，来源于星球大战的一个角色，绝地大师尤达（Yoda）。剧中，该角色喜欢以颠倒的语序说英语。比如“当九百岁你活到，看起来很好你将不”。
  下面举个栗子：

```js
// 正常的写法
if(number == 7){/* code */}

// 尤达表达式
if(7 == number){/* code */}
```
  特点就是：将表达式的常量部分放在条件语句的左侧。
优点
- 捕捉编写程序意外引起的错误
  例如以下判断，由于判断相等少写了一个=号，导致程序运行中发生意外的赋值操作

```js
if (number = 7) { /* code */ }
```
  而使用尤达表达式，则可以在编译时捕捉到这个错误

```js
if (7 = number) { /* code */ } // Uncaught ReferenceError: Invalid left-hand side in assignment
```
- 解决不安全的null类型操作
  例如Java中的equals比较
```java
String myString = null;
if (myString.equals("hehe")) { /* code */ } // This causes a NullPointerException in Java
```
  尤达表达式的方式可以避开

```java
String myString = null;
if ("hehe".equals(myString)) { /* code */ } ```
缺点
  与常规的编程直线思维相悖，造成代码阅读和理解上的不顺畅，缺乏可读性。

# 参考资料

1.[ECMAScript 规范](https://tc39.es/ecma262/#sec-ordinary-object)
2.《vue.js 设计与实现》霍春阳
